<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dice Roller</title>
    <style>
        :root {
            --bg-color-light: #f4f4f9;
            --text-color-light: #333;
            --dice-bg-light: #fff;
            --dice-border-light: #ddd;
            --dot-color-light: #000;
            --button-bg-light: #007bff;
            --button-text-light: #fff;
            --button-hover-light: #0056b3;

            --bg-color-dark: #121212;
            --text-color-dark: #f1f1f1;
            --dice-bg-dark: #2a2a2a;
            --dice-border-dark: #555;
            --dot-color-dark: #fff;
            --button-bg-dark: #bb86fc;
            --button-text-dark: #000;
            --button-hover-dark: #9a67d6;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }

        .light-mode {
            --bg-color: var(--bg-color-light);
            --text-color: var(--text-color-light);
            --dice-bg: var(--dice-bg-light);
            --dice-border: var(--dice-border-light);
            --dot-color: var(--dot-color-light);
            --button-bg: var(--button-bg-light);
            --button-text: var(--button-text-light);
            --button-hover: var(--button-hover-light);
        }

        .dark-mode {
            --bg-color: var(--bg-color-dark);
            --text-color: var(--text-color-dark);
            --dice-bg: var(--dice-bg-dark);
            --dice-border: var(--dice-border-dark);
            --dot-color: var(--dot-color-dark);
            --button-bg: var(--button-bg-dark);
            --button-text: var(--button-text-dark);
            --button-hover: var(--button-hover-dark);
        }
        
        .top-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 15px;
        }

        .main-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .dice-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 40px;
            margin-top: 20px; /* Added margin */
            margin-bottom: 20px; /* Added margin */
            perspective: 1000px;
            min-height: 110px; /* Reserve space */
        }

        .dice {
            width: 100px;
            height: 100px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .face {
            position: absolute;
            width: 100px;
            height: 100px;
            background-color: var(--dice-bg);
            border: 2px solid var(--dice-border);
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-sizing: border-box;
            backface-visibility: hidden;
        }

        .dot {
            width: 20px;
            height: 20px;
            background-color: var(--dot-color);
            border-radius: 50%;
            position: absolute;
        }

        .front  { transform: translateZ(50px); }
        .back   { transform: rotateY(180deg) translateZ(50px); }
        .right  { transform: rotateY(90deg) translateZ(50px); }
        .left   { transform: rotateY(-90deg) translateZ(50px); }
        .top    { transform: rotateX(90deg) translateZ(50px); }
        .bottom { transform: rotateX(-90deg) translateZ(50px); }

        /* Dot positions */
        .one .dot:nth-child(1) { top: 40px; left: 40px; }
        .two .dot:nth-child(1) { top: 20px; left: 20px; }
        .two .dot:nth-child(2) { top: 60px; left: 60px; }
        .three .dot:nth-child(1) { top: 20px; left: 20px; }
        .three .dot:nth-child(2) { top: 40px; left: 40px; }
        .three .dot:nth-child(3) { top: 60px; left: 60px; }
        .four .dot:nth-child(1) { top: 20px; left: 20px; }
        .four .dot:nth-child(2) { top: 20px; left: 60px; }
        .four .dot:nth-child(3) { top: 60px; left: 20px; }
        .four .dot:nth-child(4) { top: 60px; left: 60px; }
        .five .dot:nth-child(1) { top: 20px; left: 20px; }
        .five .dot:nth-child(2) { top: 20px; left: 60px; }
        .five .dot:nth-child(3) { top: 40px; left: 40px; }
        .five .dot:nth-child(4) { top: 60px; left: 20px; }
        .five .dot:nth-child(5) { top: 60px; left: 60px; }
        .six .dot:nth-child(1) { top: 20px; left: 20px; }
        .six .dot:nth-child(2) { top: 20px; left: 60px; }
        .six .dot:nth-child(3) { top: 40px; left: 20px; }
        .six .dot:nth-child(4) { top: 40px; left: 60px; }
        .six .dot:nth-child(5) { top: 60px; left: 20px; }
        .six .dot:nth-child(6) { top: 60px; left: 60px; }

        .controls {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-top: 20px; /* Added margin */
            padding: 20px;
        }

        button, select {
            padding: 12px 20px;
            font-size: 16px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
        }

        button {
            background-color: var(--button-bg);
            color: var(--button-text);
        }

        button:hover {
            background-color: var(--button-hover);
        }
        
        button:active {
            transform: scale(0.98);
        }

        .icon-button {
            background-color: var(--button-bg);
            color: var(--button-text);
            border: none;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            display: flex; /* Added for SVG centering */
            align-items: center; /* Added for SVG centering */
            justify-content: center; /* Added for SVG centering */
        }

        .icon-button svg {
            width: 24px; /* Adjust size as needed */
            height: 24px; /* Adjust size as needed */
        }
        
        #total-sum {
            font-size: 24px;
            font-weight: bold;
            min-height: 30px; /* Reserve space */
        }

    </style>
</head>
<body class="light-mode">

    <div class="top-controls">
        <button id="lang-toggle" class="icon-button" title="Switch language"></button>
        <button id="theme-toggle" class="icon-button">🌙</button>
    </div>

    <div class="main-content">
        <h1 data-lang-sv="Tärningskast" data-lang-en="Dice Roll">Tärningskast</h1>
        <div id="dice-container" class="dice-container"></div>
        <div id="total-sum"></div>

        <div class="controls">
            <label for="dice-count" data-lang-sv="Antal tärningar:" data-lang-en="Number of dice:">Antal tärningar:</label>
            <select id="dice-count">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
            </select>
            <button id="roll-button" data-lang-sv="🎲 Kasta" data-lang-en="🎲 Roll">🎲 Kasta</button>
        </div>
    </div>

    <script>
        const diceContainer = document.getElementById('dice-container');
        const rollButton = document.getElementById('roll-button');
        const diceCountSelect = document.getElementById('dice-count');
        const themeToggle = document.getElementById('theme-toggle');
        const langToggle = document.getElementById('lang-toggle');
        const totalSumDiv = document.getElementById('total-sum');

        const faceClasses = ['one', 'two', 'three', 'four', 'five', 'six'];
        const faceTransforms = {
            1: 'rotateX(0deg) rotateY(0deg)',
            2: 'rotateX(-180deg) rotateY(0deg)',
            3: 'rotateX(0deg) rotateY(-90deg)',
            4: 'rotateX(0deg) rotateY(90deg)',
            5: 'rotateX(90deg) rotateY(0deg)',
            6: 'rotateX(-90deg) rotateY(0deg)'
        };

        const translations = {
            'Tärningskast': { sv: 'Tärningskast', en: 'Dice Roll' },
            'Antal tärningar:': { sv: 'Antal tärningar:', en: 'Number of dice:' },
            '🎲 Kasta': { sv: '🎲 Kasta', en: '🎲 Roll' },
            'Summa:': { sv: 'Summa:', en: 'Sum:' }
        };

        let currentLang = 'sv';

        // SVG for flags
        const ukFlagSVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 300">
  <rect width="600" height="300" fill="#00247d"/>
  <path d="M0 0l600 300M600 0L0 300" stroke="#fff" stroke-width="60"/>
  <path d="M0 0l600 300M600 0L0 300" stroke="#c8102e" stroke-width="40"/>
  <path d="M300 0v300M0 150h600" stroke="#fff" stroke-width="100"/>
  <path d="M300 0v300M0 150h600" stroke="#c8102e" stroke-width="60"/>
</svg>`;
        const swedishFlagSVG = `<svg width="160" height="100" viewBox="0 0 160 100">
  <rect width="160" height="100" fill="#006AA7"/>
  <rect x="70" y="0" width="20" height="100" fill="#FECC00"/>
  <rect x="0" y="40" width="160" height="20" fill="#FECC00"/>
</svg>`;

        function createDice(value) {
            const dice = document.createElement('div');
            dice.classList.add('dice');
            for (let i = 1; i <= 6; i++) {
                const face = document.createElement('div');
                face.classList.add('face', faceClasses[i - 1]);
                if (i === 1) face.classList.add('front');
                if (i === 2) face.classList.add('back');
                if (i === 3) face.classList.add('left');
                if (i === 4) face.classList.add('right');
                if (i === 5) face.classList.add('top');
                if (i === 6) face.classList.add('bottom');
                
                for (let j = 0; j < i; j++) {
                    const dot = document.createElement('div');
                    dot.classList.add('dot');
                    face.appendChild(dot);
                }
                dice.appendChild(face);
            }
            setDiceValue(dice, value);
            return dice;
        }

        function setDiceValue(dice, value) {
            dice.style.transform = faceTransforms[value];
            dice.dataset.value = value;
        }

        function rollDice() {
            const diceElements = diceContainer.querySelectorAll('.dice');
            let totalSum = 0;
            rollButton.disabled = true; // Disable button during roll

            diceElements.forEach(dice => {
                const randomValue = Math.floor(Math.random() * 6) + 1;
                const randomX = (Math.floor(Math.random() * 8) + 4) * 360;
                const randomY = (Math.floor(Math.random() * 8) + 4) * 360;
                
                dice.style.transform = `rotateX(${randomX}deg) rotateY(${randomY}deg)`;
                
                setTimeout(() => {
                    setDiceValue(dice, randomValue);
                }, 1500);
                totalSum += randomValue;
            });
            
            setTimeout(() => {
                if (diceElements.length > 1) {
                    const sumText = translations['Summa:'][currentLang];
                    totalSumDiv.textContent = `${sumText} ${totalSum}`;
                } else {
                    totalSumDiv.textContent = '';
                }
                rollButton.disabled = false; // Re-enable button
            }, 1550);
        }

        function updateDiceCount() {
            diceContainer.innerHTML = '';
            totalSumDiv.textContent = '';
            const count = parseInt(diceCountSelect.value);
            for (let i = 0; i < count; i++) {
                diceContainer.appendChild(createDice(1));
            }
        }

        function setLanguage(lang) {
            currentLang = lang;
            document.documentElement.lang = lang;
            document.querySelectorAll('[data-lang-sv]').forEach(el => {
                const key = el.dataset.langSv;
                if (translations[key] && translations[key][lang]) {
                    el.textContent = translations[key][lang];
                } else {
                     el.textContent = el.dataset[`lang-${lang}`];
                }
            });
             // Manually update sum text if it exists
            if (totalSumDiv.textContent) {
                const currentSum = totalSumDiv.textContent.split(' ').pop();
                const sumText = translations['Summa:'][currentLang];
                totalSumDiv.textContent = `${sumText} ${currentSum}`;
            }
        }

        rollButton.addEventListener('click', rollDice);
        diceCountSelect.addEventListener('change', updateDiceCount);

        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            document.body.classList.toggle('light-mode');
            
            const isDarkMode = document.body.classList.contains('dark-mode');
            themeToggle.textContent = isDarkMode ? '☀️' : '🌙';
        });

        langToggle.addEventListener('click', () => {
            const newLang = currentLang === 'sv' ? 'en' : 'sv';
            setLanguage(newLang);
            langToggle.innerHTML = newLang === 'sv' ? ukFlagSVG : swedishFlagSVG; // Using SVG
            langToggle.title = newLang === 'sv' ? 'Switch to English' : 'Växla till svenska';
        });

        // Initial setup
        updateDiceCount();
        setLanguage(currentLang);
        // Set initial flag and title based on currentLang
        langToggle.innerHTML = currentLang === 'sv' ? ukFlagSVG : swedishFlagSVG;
        langToggle.title = currentLang === 'sv' ? 'Switch to English' : 'Växla till svenska';

    </script>
</body>
</html>
